open System

open Fable.Import
open Fable.Core
open Elmish
open ModelsCommon
open ModelsClient

// This could come from a json file
let spriteLoadInfos =
    [ { Name = "Penguin"
        Width = 64
        Height = 64
        Layers =
            [ 0, Default, "data:image/png;base64,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" ] }
      { Name = "Fable"
        Width = 64
        Height = 64
        Layers =
            [ 0, Ripple, "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABfWlDQ1BJQ0MgUHJvZmlsZQAAKM+lkMFLAkEYxZ9aKGUY5KGgwx6kQyiEHepYdhBCRMwgq8s6uhqsuuwqER07dPXgpaJLFv0HdYv+gSAIqlMEde5QEEHI9sYVhKhD9C0z348382ZnHuBu6KJs9U0B5UrNTMdjykp2VfE+wodhBDGDMVVYxnwqlcCv9X4Ll+w3EXkW/laD+YIlAJePPCsMs0aeIyc3a4bkBjkoSmqefEwOm7wg+VrqOYefJRcd/pBsZtILfJufrBQdDkvOOSzfooiSWSbr5FBZr4vufeRL/IXK8hL7eGdYSCOOGBTkUMcGdNQQYa8ws5990Y4viSo9grOBLZh0FFGiN0y1zlML7Br1Aj+dO1gy+++ZWtp01PmDfxHof7Ltt0nAewC0d23788i22y3Acw9cNnv+apNxvlBv9LTQIRDYAc4uelruBDhnxqMPhmqqHcnD4dY04PUUGMoCI8x6YO2/607e3XW07oDMNpC4Avb2gQnuD6x/AVxadM7rabjcAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAPvUlEQVR4XuVbaXhU1Rn2f3+1fQRCNlmSTGafBDBFCYlsgSRkg7i2apWW1rZuWKvWBmgAi9K6tGotgmLd61IJMCGAFUSryCJgoslMAEMW9gTCJsS373fOvXMnyYQGjCR5/PE+986953z3fO+3nhO4pDl4I74Rag1EeteH0RL8MZp3/waXHKnJwYUhG62BLByvzcKJwES01kzCkersCOP6IKpz0FydhSPB63BJc/VU/jhP1EzFKSpetfUWLPXPwjNbFmF75c9xKjiR73M7j++DOCwkBG8QD5hKVrqP5ppcKj8Jez+7FoNLNuJV/z1YvOVxXLr8EKqqbsaZwHh+IDfi3L4CMWCIAPnRfYjyk6n8dbCVroNt7gb8q+IuLN26CENWNCBmRSMqK2/lmAkhEiLL6X1cAAGm5a9D0rw1GPlQBWzz1msCtj2Coav2wu0PILasCTsqZ6ItKJ5gMd7XcN4EaOWvR+K8tUj9UwVGPbwa9nnvhTxg2Mo6eMpr4F1Vg6gV+/HRZ7/C18FMHXMR5PU2zoMAbfn6Srr9vHeRSsuPeLgCly+MQIC/hiRUk4RqRJXtx/oddwHBq5SMyLJ7D90kQJTPpvLXImk+Lf/QGlq+XCl/Oa/JJODVclaBbULAXnjpAZqEGoZDLQYvb4B/5++AAD1BkdB3iOgGAUbMU3nb/HVK+RF0e1P5UbzGlvwX738wA/7t92NA2WGlvJDgVSR8rkiIYk4o2/57oDbDyAd9g4T/Q4DO9vWV19PtmfAWrG1neVE+bvZGLCt/EKgbp5RbvPkR5famBwgJXn813OUBRL/TiDe3zWY4ZCjZfYGErglg+Qpl+1LJ9msxUiluKR8/+wO8UPEA0JRBD5mOFnZXqM3Es1sexqCyAxYJKiSqeR8gOfvw/JaHOG4sO7HeJ6ELArTlRXkr27e3/GVU/sXVVP5AGp5ZWYpFb5fiq11sKzlXlHt6859Jwj5FgEqIJgkkRcj5++ZHgV1jFdG9SUJEAsLr/IiwbN9Z+R/hpTX344f3f4znyh9QBJiuLZ7w9CePUlmGQxgJiggienkjHv/4byQhvVebpRABYjlt+SyV8MLrfLjy8SUbsKyCyYyWF+UlDKQKPLfqQRIwyRAsCpEEWvjpTY8qt9ckWAQIBvP5Qx89w3EZaOEG6nCHxV0MWB7ARuU0LShNTtK8dV1a/vnyP1D50Xi54kEqv0E9lz7gOX84AQISSsti1xg8SU+IkpzQkQSGw+AVTZj74VKOyyQJsktrv8BvGyECjgem4NPNt2D43PeofIdsTy9wsud/5717gMZ0/K1sNuJK3qfyJIjvIxMgMEioTcerW/+I4Sv3hAgwSZAqEUMSfr7+bZwJyvyLmw/CCMjGjm03cnOzFr4/retMAEPitXX3KgKeXVVC6288LwKWbVmAhAgEiBcIAbe//yZO9yYBEgI6/hkCpXT/jiFAEiTelxkh8NKa+0Ik2NkaP+f/vZEETeGG8rvH4CmVByKEABFN5Wd/uESFysVWXhAhCerGRyVBktCx/Encv7BaJ8GXFQnvMwlu6JQEdfynqyQYI0kwvCcwIA3TQiMJ9obyAssDQg91A1RfdQ0c89eQBAkHPwmwSBgy5wMsXc3u7+BovP7uffgBy+DS8vstD1CWH8sy9wR3hO0bIpOA6OX78eSmxxRJWvk+Q4BAe0LT58V0b5KwoENOEE9gElziZzgcTGNlKMGif5eqKmJa/vFNT7DMmT0AYZAg10FlB7lzXKgapt5UXtAlAXIVT2iiJ9hkB6hICPMEXqUsLvGXsBUeg8bKIhw1lH9q01/aWV46QGV5f4DKN+HlraVKeR124d+9+OiCAIFJQhaaKq+GXcKhoyeoxCieQBLqJlJ53fi0j3kqz3u1GWL399Z22QyZlu/4zYuPcxBgQneHDZXXIHl+hc4JqvxZ4RDH7fD6jTOxcvsD3A4fMtxeNj/V8K0KwLW6GlHLm7BqB9tn2Qmq06F+QwBB1z7BnLD/82voCauNxKg9Qa7SB7xWPguLtz2iDkS08uLyNXBS+Zh3DuA/O+8MHYj0Bdc30T0CCNm6Sk44wJwQ8gQjJ3Q6ElNuH1AExJQ14sPP7sDXwXGU03HT802IMOfKNbKc7hDdbQI0tCdIOKicYHiC3TwVDjsUFeWlydn22S/RFtDKd5QlVyGkI7pSyALfq5Nmg1AjpMRI1nxrTGQZGudJgBYontBQJYlRmqV1qhPUx+JCQD08q2oQX9aAyqpbcVaOxWVx7eTk4migEF835rG1ZuVonBrCmb2iSL4aE/7d9r85vzYPZ/cWAvsp4/A04FAxcITXgwVoayrAyT0FYd/smoTzJkAggk8Hs9AoOYF9QuLcjSTgTiyhBwxdsRdxRHXVLfgqMIHjOyt/LJiH6o8mYuaMKzDrdgt3/mo0Fs7NJAnyt8X2c0xrtgRI2IFC1H+aiwVz0pE/NRUpHicSEpJgt9uRmenD7TPTsPr1CYqQE7v1ersi4YIIEJie0Pj51YidvR6v+O/BP7Y+hgHL9yH4xU1a+ZBLtsdxLmpLRRYuHeyELdkdwrDhLuRMGQnsy2s/j3IOyTwS19Y0DTNvScPAqGQkJrnhdLnh8Xjh9Xng9XrgcnuQbHcjdmgyRnid2L5hMj0rX603fA0mLpgAgQg9HZyMmu03sxu8G4u3LERV1QycCuhdXSTlBULAtnVZiBvmRgoXnuLzKjidHhTlj+pEgHynNcB5dYXweO1IsLngU3OMuSmWDA0PfCleuEjMpVEOrHxlIsNNwqr9OgTfiACBXtwUnKwlAllorZnM510rL+hEABcr6IoAkSfunDnGSeuGKc05PlN5kaFkGTDGCFEDohKwc0MOv6tDKXwt35gAC+JiWvFzKS84HwLkerouD6/8Yxzihzi05Q0lfZwrbj880Y3LhrowlCHkoAztHZoQX4oPdocPcXFJKnz0Oq219CAB3Ud3CVAkcIE4WIjxV3nhdqVoiysL+xj7opwHLzyVgU/KJ8H/2gTcUHw54ofaVQj4OGZYggupqS5sey8bJ3eJ3H5FAMtddR5ONxRhYEwiUqmQSYAoFz/URnmFaGtk2aN7n96TD7ROw59LxyI6zoUozlk4+0qGTzGrQT6Vle/3IwJk7LHaXAQ35SLuMrq/MU4lOKcLxdPS2AMUcJyEnobEOFqKcNvNaQhuYY+wz+wp5F3n3NQ/CPg4RxOg4l8T4Gb5y5WS2VKoFTfG6/tcnGWTdWwXn4VZvaPygr4fAjJ+TyEGxdiRmuK2SOA1Nt7OOs8K0VRIuVQkjAhtceMaetYZfZ4A5dKHizGCiczt9bUb7yUJ4hmL/5qhxpytn8pOkfNEcYVzl2NBnw8BIeFsQx7mP5COhCQXx8tYc44uebr8OfDkI+lso7k/YNwfqxXl8ijj3CT0eQIER4NTubkpRFx8Mus+x3YgQX57pB9gaxwTZ8Pd3FM07qTnHMhTc89FQr8gQO6/qsvFf8qmYMCgJHgMpU3lBapCyJWQfcXAaBtum5HGbxXRK3SlCF+DiX5BgLn4tn2FWPtWFqKjnbBzrE6I0u1ZhMi9QHqGpGQvYpgo33lxIrfLRSE54egnBAhk8cwHe/PQVJWP7CwqF+fkblDms0GiHN0kGZ6gSJFW2YtBg5Px8Bw2RBFI6EcEaEiGbw2y9DUXY8PyiciakILBsclqk6Q8Qimvr6ZcuR/IMvrG8+MZDpTN6mDK63cEiAWFBKkOJ/cw0R2Zji8+zFHxPjjWRrcXmWbLrOUKMXJeMCTexYoyHc0slVIiRV4/JEBgWNAgopWbHOwvwPFdBSj57ZWIjk9UhySmbJ0rpFw68fyTV+HslzqxioxviQC9wK6UuNAkqJ9Z7ms2SuY7KXnYn4/67flw2O1w+1LCSPConeNPf3I55VuHIz1PgHRfalHiomYjYi1aIAR8um5yBALcKMrrQIAhT2ScYG+PA0XGOZ/INGWb4HOOb6vPQ8UbEzAkgbKV9fU35LjsqowUJcMc34MEUCA/Lv/O50RtAZNUId5eNg5tTdyGmu8NnNidh02rJyK+AwEOEjC9kDs8WlHJpOKHAjloDdDFmcF3bpgCp8eJTypy8NWXkswsuUKESfQxekJLTT4bJ3vI/QVujwdpI13qBFnP60ECxGL6xLYA1ZtykDnGi+99385MnYMztIheJMdy0fL7n8+Mx/BEsZBFgBxm/uKndNEma4uLhgK0MLZn3DQKA2Pp1g4XEpMcaN5diDNCgigiRBiQb8gJ0uY1WbisA8HiAZniAYe4HkVeTxFAy7dIaWqchlm/Hq1KjsvFzMv2NHG4DQ1V9AgmqbN1U/F1QxG3sMW4Ms0NFy1iLZBj2couKs1Qmxoh4Ex9ARbMGYPY2CTYjLNAdRbgJlk2OzbRE3C0kOPz2SnmKYj3nGTn96NRbnqLEKBlyzfsJPhnN43u+Rwglj/xZTHb1GFIohKpXuPoisq5vakYMiQJ9911BZY8kYlFfxyDkSPcsHM/L+d1oQXyGhPnYHKchFbGuBDQ1piPO36RhmEJVIQKmDK1XJ/aDk+aMIKkXYGX/p6JZZR/522j+T02SFTel2ImQT1Hzg3fXJqJU/Qcc+09QoB21XzcczsXS7f2pRoLFcvyKnFoI/sJiXRfm1vFoqW4vhdvSKPV0GwdXKqQOjidW2FmcHZ8qRxndXtarovPRebwBJc6HJUwkm2ykq/WoOULYcnJDsq7BkfVf5rSa+8hAliCarIZ/1czybhhc+oFSOnRizUXE3YNs6YoMmAQXdo/GSfY3Fiyc7mtZQ6ozYODi7c5XYoAndjCZcvvMJnqnQG+k3b4Um6iPq7IwqndkqjNY7IeToKttbk4LvE3wqndlh9Xi1ULtBakoe/dDJcBUTY89ZcMFb+mZSy5uvydrJvOtteFeHZzbjY5Wq7IFK8Q+Rpyr39rouxOJ3eGyfC/MUnlKF0pTPQgAQIRfpxtprhtyb1XqFNZOZa2O5jwmLikO/PQ1cVtJSTih/Cd3YF33+TiDlB5lZn1wtrLldI2RSXPN5aOR2qKk/HvUEnTQdluZneRq2TzXr4n4RBFxYuLRmLfDibgvUJutiHT+kaPEiAQElp4Bet/K/fiSx8bi5tvTENmOhNSigOjGM+TJ3kw67YrseqVcaomn/rSKJERlDdhvpcSJ3li69opWDgnHdddOwoZY1JJioPJ1YVxmV7cypL59KJ0NO7Ip/xCdTqkLd9Zbo8TYEI+eDSYg9NkXsjAQeJwsTrGxv4iNkhyji/ZmAs4h+LtYTY7Eha649OyKfMwy6uAXR6a8nCmTo7F9Nhzyf/WCNCL5VVaWfMZ7/VvuXZtle5At8f6asq10H3ZIQJkwncNYiTLAxST30Vks99QHiB/YfkugnkoeBP+B3dGfh7yquuoAAAAAElFTkSuQmCC" ] } ]

    |> List.map (fun info -> info.Name, info)
    |> Map.ofList


let start() =

    // Connect to the server and wait for messages.
//    let webSocket = Browser.WebSocket.Create("")
    let serverRequest = fun _ -> ignore() // fun (m : ServerRequest) -> m |> Serialize.toJson |> webSocket.send

    let gameWorldView = GameWorldRenderer.create spriteLoadInfos (Browser.document.getElementById("GameWorld"))
    let hudView = HudRenderer.create (Browser.document.getElementById("Hud"))

    let view model dispatch =
        gameWorldView model dispatch
        hudView model dispatch

    let subscription model =
        Cmd.ofSub (view model)

    let dispatch =
        Program.mkProgram State.init (State.update serverRequest) (fun _ _ -> ignore())
        |> Program.withSubscription subscription
        |> Program.run (fun _ -> ignore())

//    // Incoming messages.
//    webSocket.onmessage <- fun message ->
//        unbox message.data
//        |> Serialize.ofJson
//        |> FromServer
//        |> dispatch
//        obj()

    AddItem "Penguin" |> dispatch
    AddItem "Fable" |> dispatch
    Advance |> dispatch


Browser.window.addEventListener("DOMContentLoaded", U2.Case1(Func<_,_>(fun _ -> start())))
